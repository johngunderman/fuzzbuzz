/*
The second reformulation of the grammar. All declarations come before usage.
There is no if-statement.
*/

Stmts -> Decls NEWLINE Uses
         with Condition {
           Uses.names subset Decls.names
         }
       ;

Decls -> Decls NEWLINE Decl
        with Action {
          Decls{1}.names = Decls{2}.names | { Decl.name }
        }
       | Decl
        with Action {
          Decls{1}.names = { Decl.name }
        }
       ;

Uses -> Uses NEWLINE Use
        with Action {
          Uses{1}.names = Uses{2}.names | { Use.name }
        }
      | Use
        with Action {
          Uses{1}.names = { Use.name }
        }
      ;

Decl -> VAR NAME EQUAL NUMBER
        with Action {
          Decl.name = NAME
        }
      ;

Use -> PRINT NAME
       with Action {
         Use.name = NAME
       }
     ;